<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>高専"寮"サバイバル</title>
    <link rel="stylesheet" href="css/style.css" />
    <!-- prefer workspace-local assets for dev server, fallback to repo-root path for GitHub Pages -->
    <link rel="icon" href="../assets/novel-icon.png" type="image/png" />
    <link rel="icon" href="/GAME-ON/assets/novel-icon.png" type="image/png" />
    <!-- inline small transparent favicon kept as fallback for dev servers -->
    <link
      rel="icon"
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAEElEQVR42mP8z8BQz0AEYBxVSFIAAAQABJREFU"
      type="image/png"
    />
  </head>

  <body>
    <!-- ポータルへ戻るはメニュー内に移動しました -->

    <div id="screen-container">
      <div id="title-screen">
        <div class="title-content">
          <h1>高専"寮"サバイバル</h1>
          <p class="subtitle">～崖っぷちの7日間と学年末試験～</p>
          <div class="protagonist-name-wrapper">
            <label for="protagonist-name">主人公の名前:</label>
            <input
              type="text"
              id="protagonist-name"
              value="としあき"
              maxlength="10"
            />
          </div>
          <div class="title-buttons">
            <button id="new-game-button">はじめから</button>
            <button id="load-game-button-title">つづきから</button>
            <div class="control-hint" id="title-control-hint">
              操作: 矢印キーで選択、Enterで決定、EscまたはMでメニュー開閉
            </div>
          </div>
        </div>
      </div>

      <div id="game-screen" style="display: none">
        <div id="game-container">
          <!-- ステータス表示エリア（上段: 日付/時間、下段: ステータス群） -->
          <div id="status-display">
            <div class="status-top">
              <div class="status-top-left">
                <span class="label" id="label-date">日付</span>:
                <span id="date-display">1日目</span>
                <span class="sep">｜</span>
                <span class="label" id="label-time">時間</span>:
                <span id="time-of-day-display">午前</span>
              </div>
              <button id="menu-button">メニュー</button>
            </div>
            <div class="status-stats">
              <div class="stat-chip stat-academic">
                <span class="label" id="label-academic">学力</span>:
                <span id="academic-display">10</span>
              </div>
              <div class="stat-chip stat-physical">
                <span class="label" id="label-physical">体力</span>:
                <span id="physical-display">80</span>
              </div>
              <div class="stat-chip stat-mental">
                <span class="label" id="label-mental">精神力</span>:
                <span id="mental-display">80</span>
              </div>
              <div class="stat-chip stat-technical">
                <span class="label" id="label-technical">技術力</span>:
                <span id="technical-display">5</span>
              </div>
              <div class="stat-chip stat-money">
                <span class="label" id="label-money">所持金</span>:
                <span id="money-display">10000</span>
              </div>
              <div class="stat-chip stat-cp">
                <span class="label" id="label-cp">人脈</span>:
                <span id="cp-display">0</span>
              </div>
            </div>
          </div>

          <!-- メイン画面 -->
          <div id="main-screen">
            <!-- メッセージウィンドウ -->
            <div id="message-window">
              <div id="character-name"></div>
              <div id="message-text"></div>
              <div id="click-indicator">▼</div>
            </div>

            <!-- フォーカス中のキャラクター表示 -->
            <div
              id="focused-character"
              class="stat-chip"
              style="margin-bottom: 12px; display: none"
            >
              <span class="label" id="focused-character-label">フォーカス</span
              >:
              <span id="focused-character-name"></span>
              <span style="margin-left: 10px; opacity: 0.8">信頼度:</span>
              <span id="focused-character-trust"></span>
            </div>

            <!-- 選択肢エリア -->
            <div id="choices-area">
              <!-- JavaScriptによって動的に生成されます -->
            </div>
          </div>

          <!-- メニューオーバーレイ -->
          <div id="menu-overlay" class="hidden">
            <div id="menu-content">
              <h2>メニュー</h2>
              <div class="control-hint" id="menu-control-hint">
                操作: 矢印キーで選択、Enterで決定、EscまたはMでメニュー開閉
              </div>
              <button id="menu-close-floating" aria-label="閉じる">✕</button>
              <div class="menu-scroll">
                <div id="menu-controls" class="menu-controls">
                  <button id="toggle-items-button" class="menu-toggle-btn">
                    アイテム
                  </button>
                  <button id="toggle-history-button" class="menu-toggle-btn">
                    行動履歴
                  </button>
                  <button id="toggle-characters-button" class="menu-toggle-btn">
                    キャラクター
                  </button>
                  <button id="toggle-report-button" class="menu-toggle-btn">
                    レポート
                  </button>
                </div>
                <div id="menu-status-section">
                  <h3>ステータス</h3>
                  <p>学力: <span id="menu-academic"></span></p>
                  <p>体力: <span id="menu-physical"></span></p>
                  <p>精神力: <span id="menu-mental"></span></p>
                  <p>技術力: <span id="menu-technical"></span></p>
                  <p>レポート負債: <span id="menu-report-debt"></span></p>
                </div>
                <div id="menu-item-section" class="collapsible is-hidden">
                  <h3>アイテム</h3>
                  <ul id="menu-item-list"></ul>
                </div>
                <div id="menu-characters-section" class="collapsible is-hidden">
                  <h3>キャラクター</h3>
                  <ul id="menu-characters-list"></ul>
                </div>
                <div id="menu-report-section" class="collapsible is-hidden">
                  <h3>レポート</h3>
                  <ul id="menu-report-list"></ul>
                </div>
                <!-- 専用ウィンドウ: アイテム -->
                <div id="menu-item-window" class="menu-window hidden">
                  <button class="menu-window-close">✕</button>
                  <h3>アイテム</h3>
                  <div id="menu-item-window-body">
                    <ul id="menu-item-window-list"></ul>
                  </div>
                </div>
                <div id="menu-history-section" class="collapsible is-hidden">
                  <h3 id="menu-history-heading">行動履歴</h3>
                  <ul id="menu-history-list"></ul>
                </div>
                <!-- 専用ウィンドウ: 履歴 -->
                <div id="menu-history-window" class="menu-window hidden">
                  <button class="menu-window-close">✕</button>
                  <h3>行動履歴</h3>
                  <div id="menu-history-window-body">
                    <ul id="menu-history-window-list"></ul>
                  </div>
                </div>
                <div id="menu-save-load-section">
                  <h3>セーブ・ロード</h3>
                  <button id="save-game-button">ゲームをセーブ</button>
                  <input
                    type="file"
                    id="load-game-file-input"
                    accept=".json"
                    style="display: none"
                  />
                  <button id="load-game-button">ゲームをロード</button>
                  <div id="menu-audio-controls" style="margin-top: 12px">
                    <label
                      for="sound-volume"
                      style="
                        font-size: 14px;
                        display: inline-block;
                        margin-right: 8px;
                        color: #ddd;
                      "
                      >音量</label
                    >
                    <input
                      id="sound-volume"
                      type="range"
                      min="0"
                      max="1"
                      step="0.01"
                      value="1"
                      style="vertical-align: middle"
                    />
                    <button
                      id="sound-mute"
                      style="
                        margin-left: 8px;
                        padding: 6px 8px;
                        border-radius: 6px;
                      "
                    >
                      ミュート
                    </button>
                  </div>
                  <div style="margin-top: 12px">
                    <a class="portal-link" href="/GAME-ON/">ポータルへ戻る</a>
                  </div>
                </div>
              </div>
              <button id="menu-close-button">閉じる</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- スクリプトファイル -->
    <script type="module" src="js/main.js"></script>
  </body>
</html>
