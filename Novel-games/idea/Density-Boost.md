# 密度強化アイデア集（実装指針付き）

この文書は「短時間で“手数”と“選択”を増やす」ことに特化した密度アップ案です。現在の実装（eventsData.js / CONFIG / GameManager / UI）の枠内で入れやすい順に並べています。

## 1. 方針（レイヤー別に足す）
- レイヤーA: マイクロ行動（常設アクションのバリエーション）
- レイヤーB: アンビエント・ミニイベント（各ターン20〜40%で小事象）
- レイヤーC: チェーンイベント（旗で2〜3段階に分岐）
- レイヤーD: 動的ショップ（お買い得/特売/差し入れ）
- レイヤーE: NPC誘い（CPや曜日で“声かけ”が来る）
- レイヤーF: デイリー目標/実績（小さな達成で小報酬）

必要工数の目安: A/Bは“追加データだけ”でOK。C/D/E/Fは小さな補助フラグ・履歴スキャンで実装可能。

---

## 2. レイヤーA: マイクロ行動（常設アクションの増殖）
「勉強」「休む」「バイト」「レポート」を“細目化”して、同一ターン内でも迷えるようにします。既存の STUDY_ACTION/WORK_ACTION/REPORT_ACTION/REST_ACTION に加えて、以下を eventsData.js にアクション扱いで追加（次アクションは showMainActions に戻す）。

- FLASHCARD_STUDY（暗記カード）: 学力+2, 精神-2
- GROUP_STUDY（勉強会）: CP-2, 学力+6, 精神-2（成功70%/失敗は学力+2のみ）
- PAST_QUESTIONS（過去問）: 所持金-200 または CP-1, 学力+5
- QUICK_REVIEW（要点復習10分）: 学力+1, 精神-1（軽負荷）
- SHORT_NAP（10分仮眠）: 体力+2, 精神+4
- STRETCH（ストレッチ）: 体力+3
- SHOWER（シャワー）: 所持金-100, 精神+6（夜限定）
- CAFE_STUDY（カフェ勉）: 所持金-300, 学力+2, 精神+8
- DELIVERY_SHIFT（配達バイト）: 所持金+450, 体力-8, 精神+2
- SHORT_SHIFT（短時間バイト）: 所持金+200, 体力-4
- LONG_SHIFT（長時間バイト）: 所持金+600, 体力-12
- REPORT_DATA_CLEAN（データ整理）: 精神-2, レポ進行は REPORT_ACTION に委譲（メッセージ強化）

実装ヒント: 既存 ACTION と同じ EventData 形式で増やすだけ。履歴ラベルは GameManager.addHistory が面倒を見ます。

---

## 3. レイヤーB: アンビエント・ミニイベント（各ターンに“スパイス”）
GameManager.checkAndTriggerRandomEvent のフィルタ群に追加。数行メッセージ＋小さな増減だけの“軽量ネタ”で密度を上げます。

以下はそのまま定義できる候補（ID/出現/選択肢→効果）:

1) LIBRARY_SEAT_RACE（席取り合戦／平日午前）
- A: 走って確保 → 体力-2, 学力+2
- B: 空いてる席で妥協 → 精神+3, 学力+1

2) PHONE_DISTRACTION（スマホの誘惑／いつでも）
- A: 通知オフ → 精神+1, 学力+1
- B: 見ちゃう → 精神-4

3) FIND_COIN（小銭を拾う／通学時＝午前）
- Aのみ: 所持金+200

4) DORM_NOISE（寮の騒音／夜）
- A: 注意する → CP-1, 精神+2
- B: 我慢する → 精神-3

5) RAINY_MOOD（雨音集中／平日午後）
- A: 集中が続く → 精神+3, 学力+2
- B: 忘れ傘 → 所持金-500

6) LAUNDRY_JAM（洗濯機争奪／夜）
- A: 並んで待つ → 体力-2, 精神+1
- B: 明日に回す → 体力+1

7) SENPAI_HINT（先輩の一言ヒント／平日放課後）
- A: お礼に缶コーヒー → 所持金-150, 学力+3
- B: お礼は言葉だけ → CP-1, 学力+2

8) DIY_FIX（棚の補修／寮）
- A: 自分で直す → 技術+2, 体力-3, CP+1
- B: 見なかったことに → 何もなし

9) CODE_FIX_HELP（コードデバッグ助太刀／放課後）
- A: 手伝う → 技術+3, 精神-2, CP+2
- B: 断る → CP-1

10) HEALTH_CHECK（保健室で休憩／平日）
- A: 軽いストレッチ指導 → 体力+4
- B: そのまま戻る → 何もなし

確率: 20〜30%/ターン程度が目安。メッセージ密度が上がり“生きてる感”が出ます。

---

## 4. レイヤーC: チェーンイベント（2〜3段階の小連続）
フラグ（effects でも history でも可）で段階管理。

- CHAIN_MINI_TEST → CHAIN_MINI_TEST_RESULT
  - 午前の“抜き打ち小テスト（予告）”→ 放課後に結果（成功: 学力+6 / 失敗: 精神-6）。
- CHAIN_ROOM_INSPECTION → CHAIN_ROOM_CLEAN
  - 寮の点検（予告）→ 夜に“掃除”を選ぶとペナルティ回避（選ばなければ CP-1）。
- CHAIN_LAB_PREP → CHAIN_LAB_SUCCESS
  - 実験準備（技術+1）→ 翌日成功確率補正つきの“実験当日”イベント。

---

## 5. レイヤーD: 動的ショップ小ネタ
UI改修なしでできる“イベントによる付与”が簡単。
- CONVENI_CLEARANCE（コンビニ在庫処分）: チョコ1個を“差し入れ”でもらう（itemsAdd: chocolate_bar）。
- SUPERMARKET_SAMPLE（試供品）: カモミールティー1個入手。
- SCHOOL_POINTCARD（ポイントカード）: 3回購入後に次回+1個サービス（履歴数えるだけ）。

価格割引の本格実装は別途だが、“無料でもらえる”はイベントの itemsAdd で代替可能。

---

## 6. レイヤーE: NPCの“誘い”
CPや曜日で“声かけ”イベントを出す。
- TANAKA_STUDY_INVITE（田中: 平日放課後・CP>=3）
  - A: 乗る → 学力+5, 精神-2, 田中の信頼+5
  - B: 断る → 田中の信頼-3
- SUZUKI_TIP_SELL（鈴木先輩: 情報販売）
  - A: 500円で買う → 学力+5 / OR 次の試験メッセージに小ヒント
  - B: 見送る → 何もなし

実装: characters[].trust は GameManager 実装済。履歴 addHistory も対応済み。

---

## 7. レイヤーF: デイリー目標/実績（軽量）
“今日の小目標”を2つ提示（例: 勉強×2 / 休息×1 / 友人と交流×1）。
- 達成で小報酬（CP+1, 学力+2, 100円など）。
- 実装最小案: その日終わり（夜→次の日）に history を走査してカウント→報酬イベントを吐く。

実績（バッジ）サンプル:
- 「連続勉強3ターン」/「週末は休む」/「消費アイテム3回」→ メニュー履歴に行1行で表示。

---

## 8. 効果（effects）で“状態”を演出
既存の items.effect 仕組みをイベントでも使う。
- FOCUS（集中）: 学力上昇イベントの効果+1（表現はメッセージのみでもOK）/ 2ターン
- FATIGUE（倦怠）: 体力<40で自動付与 → 次ターンの行動効率-1（メッセージで警告）
- RELAX（リラックス）: 入浴剤や夜の休息で付与 → 精神系イベントで+2
- DROWSY（睡魔）: 夜更かし後に付与 → 翌午前の学力系イベント-2

数値補正をコードで一般化しない場合でも、「メッセージ＋微増減」で十分に“状態感”が出ます。

---

## 9. 具体イベント案（追加入力用ひな型）
以下フォーマットで eventsData.js へ追記するとスムーズです。
- id: AAA_BBB
- name: 表示名
- conditions: { turn: ["午前"|"放課後"|"夜"], weekday?: true|false, status?: { physical/mental/academic/technical: { min?/max? } } }
- message: 導入文
- choices: [ { text, consequences: { probability?, success?, failure?, message?, changes? } } ]
- 備考: フラグ/チェーン/履歴ラベル など

候補ID（15件）:
- LIBRARY_SEAT_RACE / PHONE_DISTRACTION / FIND_COIN / DORM_NOISE / RAINY_MOOD / LAUNDRY_JAM / SENPAI_HINT / DIY_FIX / CODE_FIX_HELP / HEALTH_CHECK / CAFE_STUDY_EVENT / LOST_KEY_HELP / REPORT_PRINT_JAM / POWER_OUTAGE_SHORT / CLUB_RECRUIT_BOOTH

---

## 10. 実装手順（最小改修）
1) レイヤーA/Bの“軽量”から着手（eventsData.js に10〜20件追加）
2) レイヤーD（差し入れ）で itemsAdd を試す（UI音と履歴が出るので気持ちいい）
3) レイヤーE（NPC誘い）を1件だけ追加→ trust 可視化の活用
4) レイヤーF（デイリー目標）を“夜→次日”のタイミングで history 解析し、報酬イベント1行を表示

---

## 11. プライオリティ付きTODO
- S: B系ミニイベント×10、A系マイクロ行動×6、差し入れ×2（合計1日作業で体感が激変）
- M: NPC誘い×2、チェーン×2、デイリー目標（履歴スキャン）
- L: 動的価格/天候/サブロケーション（UIを触るなら）

---

## 12. 備考（既存実装との整合）
- 既存のメッセージウィンドウ/選択肢/履歴/効果 サウンドがそのまま使えるため、データ追加中心で密度を稼げます。
- 技術(technical)も UI 表示済。上記イベントで積極的に増減して“高専らしさ”を演出してください。
