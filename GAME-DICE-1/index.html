<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>3Dチンチロ</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;700&display=swap" rel="stylesheet">
	<style>
		:root {
			/* 色やフォントサイズを変数として定義し、一元管理を容易にします */
			--primary-font: 'Shippori Mincho', serif;
			--bg-color: #333;
			--text-color: #fff;
			--accent-color: #f1c40f;
			--button-red-start: #e74c3c;
			--button-red-end: #c0392b;
			--button-red-shadow: #962d22;
		}

		body {
			margin: 0;
			overflow: hidden;
			font-family: var(--primary-font);
			background-color: var(--bg-color);
			color: var(--text-color);
		}

		#canvas-container {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			cursor: pointer;
		}

		#ui-container {
			position: absolute;
			bottom: 0;
			left: 0;
			width: 100%;
			padding: 20px;
			box-sizing: border-box;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			text-align: center;
			background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
			pointer-events: none;
		}

		.action-button {
			pointer-events: auto;
			font-size: 1.2rem;
			font-weight: 700;
			padding: 12px 28px;
			border-radius: 8px;
			cursor: pointer;
			color: white;
			border: none;
			text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
			transition: all 0.1s ease-in-out;
		}

		.action-button:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
		}

		.action-button:active {
			transform: translateY(1px);
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
		}

		.action-button:disabled {
			cursor: not-allowed;
			transform: none;
			box-shadow: none;
		}

		#rollButton {
			background: linear-gradient(145deg, var(--button-red-start), var(--button-red-end));
			border-bottom: 4px solid var(--button-red-shadow);
		}

		#rollButton:hover {
			background: linear-gradient(145deg, #ff6b5a, #d35400);
		}

		#rollButton:active {
			border-bottom-width: 2px;
		}

		#rollButton:disabled {
			background: #7f8c8d;
			border-bottom: 4px solid #647071;
		}

		.top-button {
			display: none;
			position: absolute;
			top: 20px;
			z-index: 10;
			font-size: 1rem;
			padding: 8px 16px;
		}

		#nudgeButton {
			left: 50%;
			transform: translateX(-50%);
			background: linear-gradient(145deg, #3498db, #2980b9);
			border-bottom: 4px solid #216a9a;
		}

		#nudgeButton:hover {
			background: linear-gradient(145deg, #5dade2, #3498db);
		}

		#nudgeButton:active {
			border-bottom-width: 2px;
		}

		#rearrangeButton {
			left: 20px;
			background: linear-gradient(145deg, #2ecc71, #27ae60);
			border-bottom: 4px solid #1e8449;
		}

		#rearrangeButton:hover {
			background: linear-gradient(145deg, #58d68d, #2ecc71);
		}

		#rearrangeButton:active {
			border-bottom-width: 2px;
		}

		#diceTypeSelector {
			pointer-events: auto;
			position: absolute;
			top: 20px;
			right: 20px;
			z-index: 10;
			font-family: var(--primary-font);
			font-size: 1rem;
			padding: 8px 12px;
			border-radius: 8px;
			color: white;
			border: 2px solid #7f8c8d;
			background-color: #34495e;
			cursor: pointer;
			-webkit-appearance: none;
			-moz-appearance: none;
			appearance: none;
			background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23ffffff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
			background-position: right 0.5rem center;
			background-repeat: no-repeat;
			background-size: 1.5em 1.5em;
			padding-right: 2.5rem;
		}

		#diceTypeSelector:disabled {
			background-color: #7f8c8d;
			cursor: not-allowed;
			opacity: 0.7;
		}

		#result-display {
			height: 80px;
			margin-bottom: 15px;
			display: flex;
			flex-direction: column;
			justify-content: center;
		}

		#result-title {
			/* Why: clamp() を使用することで、ビューポートの幅に応じてフォントサイズが滑らかに変化します。
			   これにより、極端に小さい画面や大きい画面でもテキストが適切なサイズで表示され、
			   レイアウトの崩れを防ぎます。最小値、推奨値、最大値を設定できます。 */
			font-size: clamp(2rem, 8vw, 2.5rem);
			font-weight: 700;
			color: var(--accent-color);
			text-shadow: 0 0 5px rgba(241, 196, 15, 0.5), 0 0 15px rgba(0, 0, 0, 0.7);
			margin: 0;
			transition: all 0.3s ease;
		}

		#result-description {
			font-size: clamp(1rem, 4vw, 1.1rem);
			color: #ecf0f1;
			text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
			margin: 5px 0 0 0;
			min-height: 1.5em;
		}

		#power-meter-container {
			width: 80%;
			max-width: 400px;
			height: 20px;
			background-color: rgba(0, 0, 0, 0.5);
			border: 2px solid #aaa;
			border-radius: 10px;
			margin-bottom: 20px;
			overflow: hidden;
			display: none;
			box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
		}

		#power-meter-bar {
			width: 0%;
			height: 100%;
			background: linear-gradient(to right, #f1c40f, #e74c3c);
			border-radius: 8px;
			transition: width 0.05s linear;
		}

		/* --- レスポンシブデザイン対応 --- */
		/* Why: メディアクエリを使用して、特定の画面幅以下でスタイルを上書きします。
		   これにより、スマートフォンやタブレットなどのデバイスでUIが最適に表示されるようになります。*/

		/* タブレットサイズ向けの調整 */
		@media (max-width: 768px) {
			.action-button {
				font-size: 1.1rem;
				padding: 11px 26px;
			}

			#result-display {
				height: 75px;
			}
		}

		/* スマートフォンサイズ向けの調整 */
		@media (max-width: 480px) {
			#ui-container {
				padding: 15px;
			}

			.action-button {
				font-size: 1rem;
				padding: 10px 24px;
				/* 画面幅いっぱいに広がる場合も考慮 */
				min-width: 180px;
				box-sizing: border-box;
			}

			.top-button {
				top: 10px;
				font-size: 0.8rem;
				padding: 6px 12px;
			}

			#rearrangeButton {
				left: 10px;
			}

			#diceTypeSelector {
				top: 10px;
				right: 10px;
				font-size: 0.8rem;
				padding: 6px 8px;
				padding-right: 2rem;
				/* アイコンのスペースを確保 */
				background-size: 1.2em 1.2em;
			}

			#result-display {
				height: auto;
				/* コンテンツに応じて高さを自動調整 */
				min-height: 60px;
				margin-bottom: 10px;
			}

			#power-meter-container {
				width: 90%;
				height: 15px;
				margin-bottom: 15px;
			}
		}
	</style>
</head>

<body>

	<div id="canvas-container"></div>
	<select id="diceTypeSelector">
		<option value="normal">通常賽</option>
		<option value="shigoro">四五六賽</option>
		<option value="pinzoro">ピンゾロ賽</option>
		<option value="hifumi">ヒフミ賽</option>
	</select>
	<button id="nudgeButton" class="action-button top-button">揺らす</button>
	<button id="rearrangeButton" class="action-button top-button">再配置</button>


	<div id="ui-container">
		<div id="result-display">
			<h1 id="result-title">チンチロ</h1>
			<p id="result-description">下のボタンで投擲準備</p>
		</div>
		<div id="power-meter-container">
			<div id="power-meter-bar"></div>
		</div>
		<button id="rollButton" class="action-button">サイコロを振る</button>
	</div>

	<script type="module" src="./main.ts"></script>
</body>

</html>

